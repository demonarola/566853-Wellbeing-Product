{% extends "container.html" %}
{% block content %}
{% load static  %}
<style>

</style>
<section class="main-section center-section w-small">
    <div class="contents " style="max-width: 600px;margin:auto">

        <div class="right-section m-0 sign-in " data-simplebar>
            <div>
                {% comment %} <h2 class="p-20 m-0 text-uppercase" id='ta_title'>{{title}}</h2> {% endcomment %}
                <h2 class="p-20 m-0 text-uppercase" id='ta_title'>{{title}} REGISTRATION</h2>
                <hr class="m-0">
                <div class="p-20">               
                    <form method="post" action=''>
                        {% csrf_token %}
                        <div class="form-group">
                            <div class="row">
                                <div class="col-sm-4">
                                    <label for=''>Email</label>
                                </div>
                                <div class="col-sm-8 input-group-sm">

                                    <input type="text" name="email" class="form-control  w-100" id='email'
                                        value="{{ form.email.value|default_if_none:'' }}">
                                    <span class="input-group-addon"></span>
                                    
                                    {% for error in form.email.errors %}
                                    <p style="color: red">{{ error }}</p>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-sm-4">
                                    <label for=''>password</label>
                                </div>
                                <div class="col-sm-8">
                                    <div class="input-group input-group-sm">
                                        <input type="password" name="password" class="form-control"
                                        aria-describedby="btnToggle" data-toggle="password" id='password'>
                                        <div class="input-group-append">
                                                <span class="input-group-text"><i class="fa fa-eye"></i></span>
                                              </div>
                                        
                                    </div>
                                    {% for error in form.password.errors %}
                                    <p style="color: red">{{ error }}</p>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        <hr>
                      
                        
                     
                        {% for error in form.errors %}

                        <p style="color: red;text-align:center">Email or Password is incorrect, Please enter again</p>
                        {% endfor %}
                        <div class="row">
                            <div class="col-sm-4">
                            </div>
                            <div class="col-sm-8">
                                <div class=" d-flex align-items-center">
                                    <div class="btn-container text-center">
                                        <button type="submit" class="btn btn-default text-uppercase">sign in</button>
                                    </div>
                                    <div class="btn-container text-center ml-auto">
                                        <a href="/password_reset" class="">I forgot my password</a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {% if notes %}
                        <label>NOTE : </label>
                        <p>{{notes}}</p>
                        {% endif %}

                    </form>
                </div>

            </div>
        </div>
    </div>


</div>
    <!-- END LOGIN MODAL-->

     <!-- End div hide/show container -->
    <div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModal1" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    TEAM MEMBER
                </div>
                <div class="modal-body">
                    <input type='hidden' name='ip_address' id='ip_address' value=''/>
                    <div class='row' style='margin-top:10px;'>
                        <input type='radio' name='reg' value='register' id='reg1' style='margin-left:10px;' /><span style='padding-left:5px;color:red;'>I have already registered for a session in my company link.</span>
                    </div>
                    <div class='row' style='margin-top:10px;'>
                        <input type='radio' name='reg' value='notregister' id='reg2' style='margin-left:10px;' /><span style='padding-left:5px;color:red;'>I have not yet registered for a session in my company link.</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{%endblock content%}
{% block scripts %}
{% comment %}   
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js'></script> {% endcomment %}
    {% comment %} <script src="{% static 'assets/js/jquery-3.3.1.min.js'%}"></script> {% endcomment %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    {% comment %} <script src="{% static 'assets/js/bootstrap2.min.js'%}"></script> {% endcomment %}
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>

<script>
        $("#password").password('toggle');
</script>


 <script>
       $(document).ready(function() {
           $.get("https://ipinfo.io", function (response) {
            // $("#ip_address").val(response.ip);
                $("#ip_address").val(response.ip);
                

            }, "jsonp");
            var form_error = '{{form.errors}}';
            var ip_address = '';
            
            if(form_error == '')
        
            {   var path = window.location.href.split('/');
               
            var survey_id = ''
                /*if(path[5] != undefined){
                    survey_id = path[5]
                }
                if (path[3] == 'login' && path[6]=='custom' && path[7] == '') {
                     $('#show-modal').css({  'display': 'none' }); $('#ta_title').text('TEAM MEMBER SIGN IN'); $('.copy-section').css({  'display': 'none'});  $('#myModal1').modal({backdrop: 'static',keyboard: false,show: true });
                    }
                else if(path[2] != 'vgdss-86-20.com' && path[3] == 'login' && path[6] == undefined){
                    $('#ta_title').text('SESSION ORIGINATOR SIGN IN');
                }
                else if(path[2] == 'vgdss-86-20.com' && path[3] == 'login'){

                    $('#ta_title').text('COMPANY REGISTRATION');
                }
                else{
                    $('#ta_title').text('TEAM MEMBER SIGN IN');

                }*/
                
                $('input[name="reg"]').change(function() {
                    var ip_address = $('#ip_address').val();
                    
                    if ($(this).is(':checked') && $(this).val() == 'register') {
                        
                        $.ajax({
                            type:'GET',
                            url: '/'+survey_id+'/login_with_ip/',
                            data:{'value':ip_address},
                            success:function(){
                                window.location.href = '/'+survey_id+'/login_with_ip/';
                            }

                        });
                       // window.location.href = '/'+survey_id+'/login_with_ip/';
                    }
                    else if ($(this).is(':checked') && $(this).val() == 'notregister') {
                        $('#show-modal').css({   'display': 'block' });  $('.copy-section').css({  'display': 'block' });  $('#addRegistration').modal({   backdrop: 'static',   keyboard: false, show: true   }); $('#myModal1').modal('hide');
                    }
                    
                     });
            }
        });

        
    </script>
{% endblock scripts %}
