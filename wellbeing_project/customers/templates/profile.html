{% extends "container.html" %}
{% load staticfiles %}
{% block content %}

<style>
#progress {
  display: block;
  width:400px;
}

#progress .bar {
  height: 24px;
  width: 0%;
  background: lightblue; 
  text-align: center;
}
</style>
<section class="main-section center-section w-small">
        <div class="contents ">

            <div class="right-section m-0" data-simplebar>
                <div>
                    <div class="p-20">
                        <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                     
                                <div class="form-group">
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <label for='profile'>upload profile picture  </label>
                                            </div>
                                            <div class="col-sm-8">
                                              
                                                <div class="avatar-upload">
                                                    <div class="avatar-edit">
                                                   
                                                        <input type='file' name="profile_picture" id="imageUpload" class='fileupload' accept=".png, .jpg, .jpeg" onchange="" />
                                                        <label for="imageUpload"></label>
                                                    
                                                    </div>
                                                    <div class="avatar-preview">
                                                        <div id="imagePreview" style="background-image:url({{data.profile_picture}})">
                                                        </div>
                                                    </div>
                                                   
                                                {% comment %} <p id="upload-status"></p>
                                                <div id="progress">
                                                    <div class="bar"></div>
                                                </div>   {% endcomment %}

                                                </div>

                                                 <div class="progress">
                                                    <div id="dynamic" class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
                                                        <span id="current-progress"></span>
                                                    </div>
                                                    </div> 
                                            </div>
                                            
                                        </div>
                                        
                                    </div>
                                    
                                    <hr>
                            
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-sm-4">
                                        <label for=''>email</label>
                                    </div>
                                    <div class="col-sm-8">
                                        <input type="text" name="email" value="{{data.profile_email}}" class="form-control w-100">
                                        <span class="input-group-addon"></span>
                                    </div>
                                </div>
                            </div>
                            <hr>
                            
                            <div class="agree-sec m-0">
                                <div class="btn-container text-center ml-auto ">
                                  
                                    {% comment %} <button type='button' class="btn btn-default text-uppercase" onclick='home();'>home</button> {% endcomment %}
                                    <span style='color:red;'>Click the pencil to download your photo.</span><br/>
                                    <span style='color:red;'>When it shows 100% complete, click UPDATE.</span><br/>
                                    <button type="submit" class="btn btn-default text-uppercase">update</button>
                                </div>
                            </div>
                            {{data.error}}
                        </form>
                    </div>
                    {% comment %} <h1>File Upload</h1>
                    <form>
                    <input id="fileupload" type="file" name="files[]">
                    
                    </form> {% endcomment %}

                </div>
            </div>
        </div>


    </section>
{% endblock content%}

{% block scripts %}



<script type='text/javascript'>
 function readURL(input) {

    if (input.files && input.files[0]) {
        if(Math.round(input.files[0].size/(1024*1024)) > 1){
              alert("Image Size is too big! please choose image less than 1 Mb");
              
            }
        else{
            var reader = new FileReader();
            reader.onload = function(e) {
                $('#imagePreview').css('background-image', 'url('+e.target.result +')');
                $('#imagePreview').hide();
                $('#imagePreview').fadeIn(650);
                $(function() {
                    var current_progress = 0;
                    var interval = setInterval(function() {
                        current_progress += 10;
                        $("#dynamic")
                        .css("width", current_progress + "%")
                        .attr("aria-valuenow", current_progress)
                        .text(current_progress + "% Complete");
                        if (current_progress >= 100)
                            clearInterval(interval);
                    }, 1000);
                });
            }
            reader.readAsDataURL(input.files[0]);
        }
    }
}
$(document).ready(function(){
    $("#imageUpload").change(function() {
        readURL(this);
        
        
    });
});

function home(){
    var url = '{{request.session.url}}';
    window.location.href = url
}
</script>

    {% comment %} <script src="{% static 'assets/js/jquery.min.js' %}"></script> {% endcomment %}
    <script src='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>



 <script>
/*(function() {
  'use strict';
  
  $('#imageUpload').fileupload({
    
    add: function (e, data) {
        console.log(data)
      //$('#upload-status').text("Uploading...");
      setProgressBar(0);
      
      data.submit();
    },
    progressall: function (e, data) {
      setProgressBar(parseInt(data.loaded / data.total * 100, 10));
    },
    done: function (e, data) {
      $('#upload-status').text("Uploading Complete!");
    }
  });
  
  function setProgressBar(percentage) {
    $('#progress .bar').css(
      'width',
      percentage + '%'
    ).text(percentage + '%');
  }

}).call(this);*/



</script>  

{% endblock scripts %}